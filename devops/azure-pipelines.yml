# Azure DevOps Pipeline for FinRAG
# This pipeline installs dependencies, runs backend tests, and builds the frontend sequentially.
# Adjust pool, triggers, and steps as needed for your environment.

trigger:
  - main

pool:
  vmImage: 'ubuntu-latest'

variables:
  backendPath: 'backend'
  frontendPath: 'frontend'

stages:
  - stage: BuildAndTest
    displayName: Build and Test
    jobs:
      - job: BuildAll
        displayName: Build Frontend and Backend Sequentially
        steps:
          # Frontend build
          - task: NodeTool@0
            inputs:
              versionSpec: '18.x'
          - script: |
              cd $(frontendPath)
              npm install
              npm run build
            displayName: 'Install and build frontend'

          # Backend build
          - task: UsePythonVersion@0
            inputs:
              versionSpec: '3.9'
          - script: |
              python -m pip install --upgrade pip
              pip install -r $(backendPath)/requirements.txt
            displayName: 'Install Python dependencies'
          # Add your backend test step here if you have tests
          # - script: pytest $(backendPath)/tests
          #   displayName: 'Run backend tests'

# Add more stages/jobs for deployment as needed down the line
